@page "/"
@inject TriviaScore TriviaScore
@inject Blazored.LocalStorage.ILocalStorageService localStorage

<PageTitle>Trivia Game</PageTitle>

<div class="pageContent">

    <!-- Play button -->
    <div class="menuBox">
        <NavLink class="menuLink" href="/category-picker">
            <div class="menuBoxText">Play</div>
        </NavLink>
    </div>

    <!-- Game information button -->
    <div class="menuBox">
        <NavLink class="menuLink" href="/game-info">
            <div class="menuBoxText">Game information</div>
        </NavLink> 
    </div>

    <!-- Personal statistics button -->
    <div class="menuBox">
        <NavLink class="menuLink" href="/personal-stats">
            <div class="menuBoxText">Personal statistics</div>
        </NavLink>
    </div>

</div>


@code {
    // Initialize highScores if they are null
    // Read highscore on loading first page, used for category scores
    protected override async Task OnInitializedAsync()
    {
        
        if (await localStorage.GetItemAsync<string>("highScore_generalKnowledgeTrivia") is null ||
            await localStorage.GetItemAsync<string>("highScore_gamingTrivia") is null)
        {
            await localStorage.SetItemAsync("highScore_generalKnowledgeTrivia", 0);
            await localStorage.SetItemAsync("highScore_gamingTrivia", 0);
        }
        
        await ReadHighscore();
    }

    
    public async Task ReadHighscore()
    {
        var highscore = await localStorage.GetItemAsync<string>("highScore_generalKnowledgeTrivia");
        TriviaScore.Highscore = Int32.Parse(highscore);
    }
}
